<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>LongBlack Mini Widget - Note Explorer</title>
    <link href="https://fonts.googleapis.com/css2?family=Gowun+Batang:wght@700&family=Noto+Sans+KR:wght@400;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --accent: #ff4e00;
            --text-main: #ffffff;
            --line-color: rgba(255, 255, 255, 0.2); 
        }

        body {
            margin: 0; padding: 0;
            width: 380px; height: 200px; 
            overflow: hidden;
            background: #000;
            font-family: 'Noto Sans KR', sans-serif;
            color: var(--text-main);
            /* 위젯 드래그 가능 (PC 설치형 대비) */
            -webkit-app-region: drag;
        }

        /* --- 고해상도 몬드리안 배경 --- */
        #bg-grid {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(2, 1fr);
            gap: 1.5px;
            background-color: var(--line-color);
            z-index: 1;
        }
        .cell {
            background-color: #050505;
            transition: background-color 1.5s ease;
        }

        /* --- 콘텐츠 레이어 --- */
        .content {
            position: relative;
            z-index: 10;
            height: 100%;
            display: flex;
            flex-direction: column;
            pointer-events: none; /* 배경 드래그를 위해 */
        }

        /* 상단 바: 시계와 날짜 */
        .top-bar {
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        #time { font-size: 1.3rem; font-weight: 900; color: var(--accent); text-shadow: 2px 2px 4px rgba(0,0,0,0.8); }
        #date { font-size: 0.8rem; opacity: 0.9; font-weight: 400; text-shadow: 1px 1px 3px rgba(0,0,0,0.8); }

        /* 하단: 문장 및 버튼 영역 */
        .quote-zone {
            flex: 1;
            padding: 0 25px 20px 25px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        #quote-text {
            font-family: 'Gowun Batang', serif;
            font-size: 0.95rem;
            line-height: 1.6;
            margin: 0;
            word-break: keep-all;
            text-shadow: 2px 2px 5px rgba(0,0,0,1), 0 0 10px rgba(0,0,0,0.5);
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        /* 하단 정보바: 출처 + 탐색 버튼 */
        .bottom-bar {
            margin-top: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            pointer-events: auto; /* 버튼 클릭 가능하게 */
            -webkit-app-region: no-drag;
        }
        #quote-source {
            font-size: 0.7rem;
            opacity: 0.7;
            font-weight: 100;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.8);
            letter-spacing: 1px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 230px;
        }
        #explore-btn {
            font-size: 0.65rem;
            color: var(--accent);
            text-decoration: none;
            border: 1px solid var(--accent);
            padding: 2px 8px;
            border-radius: 2px;
            transition: 0.3s;
            letter-spacing: 1px;
            font-weight: 900;
        }
        #explore-btn:hover {
            background: var(--accent);
            color: #fff;
        }
    </style>
</head>
<body>

    <div id="bg-grid"></div>

    <div class="content">
        <div class="top-bar">
            <div id="time">00:00:00</div>
            <div id="date">2026.01.12 MON</div>
        </div>
        <div class="quote-zone">
            <p id="quote-text">영감을 불러오는 중...</p>
            <div class="bottom-bar">
                <span id="quote-source">— Loading Archive</span>
                <a id="explore-btn" href="#" target="_blank">EXPLORE</a>
            </div>
        </div>
    </div>

    <script src="quote_data.js"></script>
    <script>
        const grid = document.getElementById('bg-grid');
        const timeEl = document.getElementById('time');
        const dateEl = document.getElementById('date');
        const quoteTextEl = document.getElementById('quote-text');
        const quoteSourceEl = document.getElementById('quote-source');
        const exploreBtn = document.getElementById('explore-btn');

        for(let i=0; i<6; i++) {
            const cell = document.createElement('div');
            cell.className = 'cell';
            grid.appendChild(cell);
        }
        const cells = document.querySelectorAll('.cell');
        
        const colors = ['#FF4E00', '#003366', '#8B0000', '#228B22', '#FFD700', '#1A1A1A', '#4B0082'];

        let lastHour = -1;
        let count = 0;

        function tick() {
            const now = new Date();
            timeEl.innerText = now.toTimeString().split(' ')[0];
            const days = ['SUN','MON','TUE','WED','THU','FRI','SAT'];
            dateEl.innerText = `${now.getFullYear()}.${String(now.getMonth()+1).padStart(2,'0')}.${String(now.getDate()).padStart(2,'0')} ${days[now.getDay()]}`;

            count++;
            if (count % 5 === 0) {
                cells.forEach(cell => {
                    if (Math.random() > 0.6) {
                        cell.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                    } else {
                        cell.style.backgroundColor = '#050505';
                    }
                });
            }

            if (now.getHours() !== lastHour) {
                if (typeof quoteData !== 'undefined' && quoteData.length > 0) {
                    const item = quoteData[Math.floor(Math.random() * quoteData.length)];
                    quoteTextEl.innerText = item.text;
                    quoteSourceEl.innerText = `— ${item.source}`;
                    
                    // 구글 검색 URL 업데이트
                    const query = encodeURIComponent(item.source + " 롱블랙");
                    exploreBtn.href = `https://www.google.com/search?q=${query}`;
                }
                lastHour = now.getHours();
            }
        }

        setInterval(tick, 1000);
        tick();
    </script>
</body>
</html>
