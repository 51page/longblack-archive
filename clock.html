<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LongBlack - Time Kinetic Universe</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Nanum+Myeongjo:wght@800&family=Montserrat:wght@900&display=swap" rel="stylesheet">
    <style>
        :root { --bg: #000; --accent: #FF4E00; }
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; background: var(--bg); color: #fff; font-family: 'Montserrat', sans-serif; overflow: hidden; }

        /* [배경 데이터 레이어] */
        #universe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 1; pointer-events: none; }
        .data-fragment { position: absolute; will-change: transform, opacity; }
        .data-fragment img { width: 100%; height: 100%; object-fit: cover; border-radius: 4px; opacity: 0.6; filter: grayscale(0.5); }
        .data-fragment .title { position: absolute; bottom: -25px; left: 0; width: 200%; font-family: 'Nanum Myeongjo'; font-size: 0.8rem; color: rgba(255,255,255,0.7); white-space: nowrap; }

        /* [중앙 시계] */
        #clock-container {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            width: 300px; height: 300px; z-index: 100;
            display: flex; align-items: center; justify-content: center;
        }
        .clock {
            width: 100%; height: 100%; border: 2px solid rgba(255,255,255,0.1);
            border-radius: 50%; position: relative; backdrop-filter: blur(5px);
        }
        .hand { position: absolute; bottom: 50%; left: 50%; transform-origin: bottom; background: #fff; border-radius: 10px; }
        .hour { width: 6px; height: 70px; z-index: 3; }
        .min { width: 4px; height: 100px; z-index: 4; }
        .sec { width: 2px; height: 120px; background: var(--accent); z-index: 5; }
        .center-dot { position: absolute; top: 50%; left: 50%; width: 12px; height: 12px; background: var(--accent); border-radius: 50%; transform: translate(-50%, -50%); z-index: 10; }

        /* [UI] */
        #brand-logo { position: fixed; top: 40px; left: 40px; font-size: 1.5rem; letter-spacing: 5px; z-index: 1000; color: var(--accent); }
        #instruction { position: fixed; bottom: 40px; left: 50%; transform: translateX(-50%); font-size: 0.7rem; opacity: 0.4; letter-spacing: 3px; z-index: 1000; }
    </style>
</head>
<body>

    <div id="brand-logo">LONGBLACK</div>
    <div id="instruction">EVERY SECOND, NEW INSIGHT EXPLODES.</div>

    <div id="universe"></div>

    <div id="clock-container">
        <div class="clock">
            <div class="center-dot"></div>
            <div id="hour-hand" class="hand hour"></div>
            <div id="min-hand" class="hand min"></div>
            <div id="sec-hand" class="hand sec"></div>
        </div>
    </div>

    <script>
        let noteData = [];
        const universe = document.getElementById('universe');

        // CSV 로드
        Papa.parse("notedata.csv", {
            download: true, header: true,
            complete: function(results) {
                noteData = results.data.filter(row => row.note_title && row.thumbnail_url);
                startTimeLoop();
            }
        });

        function startTimeLoop() {
            setInterval(updateClock, 1000);
        }

        function updateClock() {
            const now = new Date();
            const h = now.getHours();
            const m = now.getMinutes();
            const s = now.getSeconds();

            const hDeg = (h * 30) + (m * 0.5);
            const mDeg = (m * 6);
            const sDeg = (s * 6);

            // 시계 바늘 움직임 (1초마다 착착)
            gsap.to("#hour-hand", { rotation: hDeg, duration: 0.5, ease: "back.out(2)" });
            gsap.to("#min-hand", { rotation: mDeg, duration: 0.5, ease: "back.out(2)" });
            gsap.to("#sec-hand", { rotation: sDeg, duration: 0.4, ease: "elastic.out(1, 0.3)" });

            // [핵심] 1초마다 데이터 파편 생성
            spawnDataFragments();
        }

        function spawnDataFragments() {
            // 매 초마다 3~5개의 새로운 파편 생성
            const count = 3 + Math.floor(Math.random() * 3);
            
            for(let i=0; i<count; i++) {
                const data = noteData[Math.floor(Math.random() * noteData.length)];
                const fragment = document.createElement('div');
                fragment.className = 'data-fragment';
                
                // 랜덤 사이즈 및 위치
                const size = 60 + Math.random() * 150;
                const startX = window.innerWidth / 2;
                const startY = window.innerHeight / 2;
                
                fragment.style.width = size + 'px';
                fragment.style.height = (size * 1.4) + 'px';
                fragment.innerHTML = `
                    <img src="${data.thumbnail_url}">
                    <div class="title">${data.note_title}</div>
                `;
                
                universe.appendChild(fragment);

                // [임팩트 있는 무빙] 중앙에서 사방으로 흩어지는 효과
                const angle = Math.random() * Math.PI * 2;
                const distance = 300 + Math.random() * 600;
                const targetX = startX + Math.cos(angle) * distance - (size/2);
                const targetY = startY + Math.sin(angle) * distance - (size/2);

                gsap.fromTo(fragment, 
                    { 
                        x: startX, y: startY, 
                        scale: 0, rotation: 0, opacity: 0 
                    }, 
                    { 
                        x: targetX, y: targetY, 
                        scale: 1, rotation: Math.random() * 40 - 20, 
                        opacity: 1, 
                        duration: 3 + Math.random() * 2, 
                        ease: "power2.out",
                        onComplete: () => {
                            // 도착 후 서서히 사라짐
                            gsap.to(fragment, { 
                                opacity: 0, 
                                y: targetY + 50, 
                                duration: 2, 
                                delay: 1,
                                onComplete: () => fragment.remove() 
                            });
                        }
                    }
                );
            }
        }
    </script>
</body>
</html>
