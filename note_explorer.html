<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>LongBlack Mosaic - Final Mobile Fix</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/Observer.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Nanum+Myeongjo:wght@700;800&family=Montserrat:wght@300;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #000000;
            --accent: #FF4E00;
            --tile-w: 120px;
            --tile-h: 170px;
            --gap: 10px;
        }

        body, html {
            margin: 0; padding: 0;
            width: 100%; height: 100%;
            background-color: var(--bg);
            color: #fff; font-family: 'Montserrat', sans-serif;
            overflow: hidden;
            touch-action: none;
        }

        #grid-container {
            position: absolute; top: 0; left: 0;
            width: 100%; height: 100%;
            display: flex; flex-direction: column;
            justify-content: center;
            gap: var(--gap);
            z-index: 5;
        }

        .grid-row {
            display: flex; gap: var(--gap);
            width: max-content; will-change: transform;
        }

        .tile {
            width: var(--tile-w); height: var(--tile-h);
            background: #111; border-radius: 4px;
            overflow: hidden; cursor: pointer;
            flex-shrink: 0;
            filter: brightness(0.5) grayscale(1);
            /* 모바일 클릭 반응성 향상 */
            -webkit-tap-highlight-color: transparent;
        }
        .tile img { width: 100%; height: 100%; object-fit: cover; pointer-events: none; }

        /* 하이라이트 오버레이 (Z-INDEX 대폭 강화) */
        #focus-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #000000; /* 블러 전 배경색 고정 */
            display: flex; align-items: center; justify-content: center;
            z-index: 9999; opacity: 0; pointer-events: none;
            transition: opacity 0.4s ease;
        }
        /* 사파리 대응 블러 처리 */
        @supports ((-webkit-backdrop-filter: blur(25px)) or (backdrop-filter: blur(25px))) {
            #focus-overlay {
                background: rgba(0,0,0,0.9);
                -webkit-backdrop-filter: blur(25px);
                backdrop-filter: blur(25px);
            }
        }
        #focus-overlay.active { opacity: 1; pointer-events: auto; }

        .focus-content {
            width: 85%; max-width: 450px;
            text-align: center; color: #fff;
            z-index: 10000;
        }

        .focus-img {
            width: 100%; max-height: 40vh;
            border-radius: 8px; object-fit: contain;
            margin-bottom: 25px;
            background: #111;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
        }

        .focus-quote {
            font-family: 'Nanum Myeongjo', serif;
            font-size: 1.15rem; font-weight: 800; line-height: 1.6;
            margin: 0 0 15px 0; color: #fff !important;
        }

        .focus-title {
            font-size: 0.8rem; font-weight: 500; opacity: 0.6; margin: 0;
            color: #ccc;
        }

        .close-hint {
            margin-top: 35px; font-size: 0.6rem; opacity: 0.4; letter-spacing: 2px;
            text-transform: uppercase;
        }
    </style>
</head>
<body>

    <div id="grid-container"></div>

    <div id="focus-overlay">
        <div class="focus-content">
            <img id="focus-img" src="" alt="Thumbnail" class="focus-img">
            <p id="focus-quote" class="focus-quote"></p>
            <h3 id="focus-title" class="focus-title"></h3>
            <p class="close-hint">CLOSE</p>
        </div>
    </div>

    <script>
        // 데이터 인덱스 사용
        const noteData = [
            { title: "영감의 탄생, 그 찰나", quote: "위대한 영감은 우연을 가장한 필연적인 축적의 결과물이다.", img: "https://longblack-contens.s3.ap-northeast-2.amazonaws.com/image/20251224/176656503563a1934c51b320fe95469a34126b5418.png" },
            { title: "비즈니스의 본질을 묻다", quote: "결국 모든 비즈니스는 사람의 마음을 얻는 과정이다.", img: "https://longblack-contens.s3.ap-northeast-2.amazonaws.com/image/20251217/1765962945ee9b56524b06910d3698879edb452464.png" },
            { title: "감각의 아카이빙", quote: "나를 정의하는 것은 내가 보고 듣고 읽은 것들의 총합이다.", img: "https://longblack-contens.s3.ap-northeast-2.amazonaws.com/image/20251217/1765962275e8eeb5995c8d6addd9153ffc4ec434ce.png" },
            { title: "기록이 쌓이면 통찰이 된다", quote: "어제의 기록이 오늘의 나를 만들고, 내일의 통찰이 된다.", img: "https://longblack-contens.s3.ap-northeast-2.amazonaws.com/image/20251211/1765433740ebaf8b810d2d1f9ead935299364919a1.png" },
            { title: "시대의 흐름을 읽는 법", quote: "변화의 파도 속에서 변하지 않는 본질을 보는 눈을 길러야 한다.", img: "https://longblack-contens.s3.ap-northeast-2.amazonaws.com/image/20251211/1765433716be1ad9dbf19817a9573785fe6ae33360.png" },
            { title: "기본으로 돌아가는 용기", quote: "가장 혁신적인 답은 언제나 가장 기본적인 질문 속에 숨어있다.", img: "https://longblack-contens.s3.ap-northeast-2.amazonaws.com/image/20251203/176474266585e9885cba40526329edaafbfcc51581.png" },
            { title: "공간의 미학", quote: "좋은 공간은 머무는 사람의 태도까지 디자인한다.", img: "https://longblack-contens.s3.ap-northeast-2.amazonaws.com/image/20251203/1764742730aeaf9a1c72017d80b52900534bd50794.png" },
            { title: "디테일의 완성", quote: "사소한 디테일 하나가 브랜드의 영혼을 결정짓는다.", img: "https://longblack-contens.s3.ap-northeast-2.amazonaws.com/image/20251125/17640579902f4c62d2fbf8001c97c38d02d59e237c.png" },
            { title: "매일의 감각을 깨우다", quote: "무뎌진 일상의 감각을 깨우는 것이 영감의 시작이다.", img: "https://longblack-contens.s3.ap-northeast-2.amazonaws.com/image/20251203/176472681167f136b488d418f792a6f7c62e7d7981.png" },
            { title: "미래의 조각들", quote: "미래는 예측하는 것이 아니라, 오늘의 조각들로 만들어가는 것이다.", img: "https://longblack-contens.s3.ap-northeast-2.amazonaws.com/image/20251121/1763724643574a7a78e625111f95a9b0bc522eb356.png" },
            { title: "브랜드의 탄생", quote: "사랑받는 브랜드는 명확한 자기다움에서 시작된다.", img: "https://longblack-contens.s3.ap-northeast-2.amazonaws.com/image/20251112/176294083545516b03ee7bd96747e27648c1080e19.png" }
        ];

        const container = document.getElementById('grid-container');
        const overlay = document.getElementById('focus-overlay');
        const timelines = [];

        // 1. 그리드 생성
        const rowCount = 6;
        for (let r = 0; r < rowCount; r++) {
            const row = document.createElement('div');
            row.className = 'grid-row';
            const repeatedData = [...noteData, ...noteData, ...noteData];
            repeatedData.forEach((data, idx) => {
                const tile = document.createElement('div');
                tile.className = 'tile';
                tile.innerHTML = `<img src="${data.img}" loading="lazy">`;
                // 인덱스를 활용한 데이터 바인딩
                tile.dataset.index = idx % noteData.length;
                
                // 모바일에서도 확실히 동작하는 표준 클릭 이벤트
                tile.onclick = (e) => {
                    e.stopPropagation();
                    const dataIndex = e.currentTarget.dataset.index;
                    showFocus(noteData[dataIndex]);
                };
                row.appendChild(tile);
            });
            container.appendChild(row);

            const tl = gsap.to(row, {
                x: r % 2 === 0 ? "-50%" : "0%",
                duration: 50 + (r * 12),
                ease: "none",
                repeat: -1
            });
            if(r % 2 !== 0) gsap.set(row, {x: "-50%"});
            timelines.push({tl, dir: r % 2 === 0 ? 1 : -1});
        }

        // 2. 스크롤 인터랙션 (Observer)
        gsap.registerPlugin(Observer);

        Observer.create({
            target: window,
            type: "wheel,touch,pointer",
            onChange: (self) => {
                // 스크롤 시 속도 가속 강화
                const power = Math.abs(self.deltaY) * 0.02;
                timelines.forEach((item) => {
                    gsap.to(item.tl, {
                        timeScale: 1 + (power * 4),
                        duration: 0.1,
                        overwrite: true,
                        onComplete: () => {
                            gsap.to(item.tl, { timeScale: 1, duration: 1.2, ease: "power1.out" });
                        }
                    });
                });
            }
        });

        // 3. 포커스 함수 (모바일 렌더링 최적화)
        function showFocus(data) {
            const fImg = document.getElementById('focus-img');
            const fQuote = document.getElementById('focus-quote');
            const fTitle = document.getElementById('focus-title');

            // 내용 먼저 채우기
            fImg.src = data.img;
            fQuote.innerText = `“${data.quote}”`;
            fTitle.innerText = data.title;

            // 오버레이 표시
            overlay.classList.add('active');
        }

        overlay.onclick = () => {
            overlay.classList.remove('active');
        };

        // 초기화
        document.fonts.ready.then(() => {
            gsap.to("body", {opacity: 1, duration: 0.5});
        });
    </script>
</body>
</html>
